Type.registerNamespace("Artem.Google");Artem.Google.DirectionsBehavior=function(a){Artem.Google.DirectionsBehavior.initializeBase(this,[a])};Artem.Google.DirectionsBehavior.prototype={initialize:function(){Artem.Google.DirectionsBehavior.callBaseMethod(this,"initialize");Artem.Worker.queue(Function.createDelegate(this,this._attach))},dispose:function(){this._detach();Artem.Google.DirectionsBehavior.callBaseMethod(this,"dispose")}};(function(a){a.map=null;a.renderer=null;a.service=null;a.get_name=function(){return this.name};a.set_name=function(a){this.name=a};a.get_avoidHighways=function(){return this.avoidHighways?this.avoidHighways:false};a.set_avoidHighways=function(a){this.avoidHighways=a};a.get_avoidTolls=function(){return this.avoidTolls?this.avoidTolls:false};a.set_avoidTolls=function(a){this.avoidTolls=a};a.get_destination=function(){return this.destination};a.set_destination=function(a){this.destination=a};a.get_optimizeWaypoints=function(){return this.optimizeWaypoints?this.optimizeWaypoints:false};a.set_optimizeWaypoints=function(a){this.optimizeWaypoints=a};a.get_origin=function(){return this.origin};a.set_origin=function(a){this.origin=a};a.get_provideRouteAlternatives=function(){return this.provideRouteAlternatives?this.provideRouteAlternatives:false};a.set_provideRouteAlternatives=function(a){this.provideRouteAlternatives=a};a.get_region=function(){return this.region};a.set_region=function(a){this.region=a};a.get_travelMode=function(){return this.travelMode};a.set_travelMode=function(a){this.travelMode=a};a.get_unitSystem=function(){return this.unitSystem};a.set_unitSystem=function(a){this.unitSystem=a};a.get_waypoints=function(){return this.waypoints};a.set_waypoints=function(a){this.waypoints=a};a.get_draggable=function(){return this.draggable};a.set_draggable=function(a){this.draggable=a};a.get_hideRouteList=function(){return this.hideRouteList};a.set_hideRouteList=function(a){this.hideRouteList=a};a.get_markerOptions=function(){return this.markerOptions};a.set_markerOptions=function(a){this.markerOptions=a};a.get_panelId=function(){return this.panelId};a.set_panelId=function(a){this.panelId=a};a.get_polylineOptions=function(){return this.polylineOptions};a.set_polylineOptions=function(a){this.polylineOptions=a};a.get_preserveViewport=function(){return this.preserveViewport};a.set_preserveViewport=function(a){this.preserveViewport=a};a.get_routeIndex=function(){return this.routeIndex};a.set_routeIndex=function(a){this.routeIndex=a};a.get_suppressBicyclingLayer=function(){return this.suppressBicyclingLayer};a.set_suppressBicyclingLayer=function(a){this.suppressBicyclingLayer=a};a.get_suppressInfoWindows=function(){return this.suppressInfoWindows};a.set_suppressInfoWindows=function(a){this.suppressInfoWindows=a};a.get_suppressMarkers=function(){return this.suppressMarkers};a.set_suppressMarkers=function(a){this.suppressMarkers=a};a.get_suppressPolylines=function(){return this.suppressPolylines};a.set_suppressPolylines=function(a){this.suppressPolylines=a};a._attach=function(){var a=$find(this.get_element().id);a&&a.add_mapLoaded(Function.createDelegate(this,this.create))};a._detach=function(){this.renderer&&google.maps.event.clearInstanceListeners(this.renderer)};a.create=function(){if(!this.service)this.service=new google.maps.DirectionsService;if(!this.map){var e=$find(this.get_element().id);if(e)this.map=e.map}var a={destination:this.destination,origin:this.origin,travelMode:this.travelMode==0?google.maps.TravelMode.DRIVING:this.travelMode==1?google.maps.TravelMode.WALKING:google.maps.TravelMode.BICYCLING},c=this.destination;a.destination=c.Latitude&&c.Longitude?new google.maps.LatLng(c.Latitude,c.Longitude):c;var d=this.origin;a.origin=d.Latitude&&d.Longitude?new google.maps.LatLng(d.Latitude,d.Longitude):d;if(this.avoidHighways)a.avoidHighways=this.avoidHighways;if(this.avoidTolls)a.avoidTolls=this.avoidTolls;if(this.optimizeWaypoints)a.optimizeWaypoints=this.optimizeWaypoints;if(this.provideRouteAlternatives)a.provideRouteAlternatives=this.provideRouteAlternatives;if(this.region)a.region=this.region;if(this.unitSystem)a.unitSystem=this.unitSystem;if(this.waypoints)a.waypoints=this.waypoints;if(a.origin&&a.destination)this.service.route(a,Function.createDelegate(this,b));else{!this.origin&&Artem.Google.Log.warn("GoogleDirections: origin value is missing!");!this.destination&&Artem.Google.Log.warn("GoogleDirections: destination value is missing!")}};function c(a){Artem.Google.Log.error("Directions routing failed with status: "+a)}function b(e,b){if(b==google.maps.DirectionsStatus.OK){var d=false;if(d=!this.renderer){var a={draggable:this.draggable,hideRouteList:this.hideRouteList,map:this.map,preserveViewport:this.preserveViewport,routeIndex:this.routeIndex};if(this.markerOptions)a.markerOptions=this.markerOptions;if(this.panelId)a.panel=document.getElementById(this.panelId);if(this.polylineOptions)a.polylineOptions=this.polylineOptions;if(this.suppressBicyclingLayer)a.suppressBicyclingLayer=this.suppressBicyclingLayer;if(this.suppressInfoWindows)a.suppressInfoWindows=this.suppressInfoWindows;if(this.suppressMarkers)a.suppressMarkers=this.suppressMarkers;if(this.suppressPolylines)a.suppressPolylines=this.suppressPolylines;this.renderer=new google.maps.DirectionsRenderer(a)}this.renderer.setDirections(e);d&&this.composeEvents(this.renderer,null)}else c(b)}a.getDirections=function(){return this.renderer.getDirections()};a.getMap=function(){return this.renderer.getMap()};a.getPanel=function(){return this.renderer.getPanel()};a.getRouteIndex=function(){return this.renderer.getRouteIndex()};a.setDirections=function(a){this.renderer.setDirections(a)};a.setMap=function(a){this.renderer.setMap(a);this.map=a};a.setOptions=function(a){this.renderer.setOptions(a)};a.setPanel=function(a){this.renderer.setPanel(a)};a.setRouteIndex=function(a){this.renderer.setRouteIndex(a);this.routeIndex=a}})(Artem.Google.DirectionsBehavior.prototype);(function(a){a.composeEvents=function(a,c){if(!this.listener){a=a||this.renderer;if(a){c=c||this.get_events().getHandler("changed");if(c)this.listener=google.maps.event.addListener(a,"directions_changed",Function.createDelegate(this,b))}}};a.add_changed=function(a){this.get_events().addHandler("changed",a);this.composeEvents(null,a)};a.remove_changed=function(a){this.get_events().removeHandler("changed",a);if(this.listener){var b=this.get_events().getHandler("changed");!b&&google.maps.event.removeListener(this.listener)}};function b(b){var a=this.get_events().getHandler("changed");a&&a(this,b)}})(Artem.Google.DirectionsBehavior.prototype);Artem.Google.DirectionsBehavior.raiseServerChanged=function(e){var c=e.getDirections().routes,f={name:"change"};if(c&&c.length>0){var d=c[0].legs;if(d&&d.length){var a=d[0];delete a.via_waypoint;delete a.via_waypoints;a.end_location={Latitude:a.end_location.Ma,Longitude:a.end_location.Na};a.start_location={Latitude:a.start_location.Ma,Longitude:a.start_location.Na};for(var b=0;b<a.steps.length;b++){delete a.steps[b].encoded_lat_lngs;delete a.steps[b].end_point;delete a.steps[b].lat_lngs;delete a.steps[b].path;delete a.steps[b].polyline;delete a.steps[b].start_point;delete a.steps[b].travel_mode;a.steps[b].end_location={Latitude:a.steps[b].end_location.Ma,Longitude:a.steps[b].end_location.Na};a.steps[b].start_location={Latitude:a.steps[b].start_location.Ma,Longitude:a.steps[b].start_location.Na}}f.route=a}}__doPostBack(e.get_name(),Sys.Serialization.JavaScriptSerializer.serialize(f))};Artem.Google.DirectionsBehavior.registerClass("Artem.Google.DirectionsBehavior",Sys.UI.Behavior)